<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sahabat Alam - Game Anak Ceria</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      @import url("https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;800&display=swap");

      body {
        opacity: 0; /* Mulai dengan tidak terlihat */
        transition: opacity 1.5s ease-in-out; /* Animasi transisi */
        font-family: "Nunito", Arial, sans-serif;
        background-color: #f0f0f0;
        overflow: hidden;
        width: 100vw;
        height: 100vh;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      .fade-in {
        animation: fadeIn 1.5s forwards;
      }

      .game-container {
        position: relative;
        width: 100%;
        height: 100%;
        overflow: hidden;
      }

      .background {
        position: absolute;
        width: 100%;
        height: 100%;
        background: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1)),
          url("../assets/Background/BgGIFchoose.gif");
        background-size: cover;
        background-position: center;
        filter: brightness(1.3) saturate(1.5);
        animation: backgroundShift 20s infinite alternate;
      }

      @keyframes backgroundShift {
        0% {
          background-position: center;
        }
        50% {
          background-position: bottom right;
        }
        100% {
          background-position: bottom left;
        }
      }

      .floating-clouds {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 1;
        overflow: hidden;
      }

      .cloud {
        position: absolute;
        background: url("../assets/Sprite/cloud1.webp");
        background-size: contain;
        background-repeat: no-repeat;
        filter: brightness(1.5);
        opacity: 0.7;
        pointer-events: none;
      }

      .cloud1 {
        width: 200px;
        height: 120px;
        top: 15%;
        animation: floatCloud 40s linear infinite;
      }

      .cloud2 {
        width: 150px;
        height: 90px;
        top: 30%;
        animation: floatCloud 35s linear infinite 10s;
      }

      .cloud3 {
        width: 180px;
        height: 100px;
        top: 5%;
        animation: floatCloud 50s linear infinite 5s;
      }

      @keyframes floatCloud {
        0% {
          left: -200px;
        }
        100% {
          left: 100%;
        }
      }

      .logo-container {
        position: absolute;
        top: 5%;
        left: 50%;
        transform: translateX(-50%);
        width: 220px;
        height: 220px;
        z-index: 10;
        animation: bounce 4s ease-in-out infinite;
      }

      @keyframes bounce {
        0%,
        100% {
          transform: translateX(-50%) translateY(0);
        }
        50% {
          transform: translateX(-50%) translateY(-15px);
        }
      }

      .logo {
        width: 100%;
        height: 100%;
        object-fit: contain;
      }

      @keyframes glow {
        0% {
          text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5),
            0 0 20px rgba(255, 255, 255, 0.7);
        }
        100% {
          text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.5),
            0 0 30px rgba(255, 255, 100, 0.9);
        }
      }

      .panels-container {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -35%);
        width: 90%;
        max-width: 1200px;
        display: flex;
        justify-content: space-around;
        z-index: 5;
      }

      .panel {
        width: 45%;
        height: 400px;
        position: relative;
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        transform-style: preserve-3d;
        perspective: 1000px;
        margin: 0 15px;
      }

      .panel:hover {
        transform: scale(1.05) translateY(-10px);
        filter: brightness(1.1);
      }

      .panel:active {
        transform: scale(0.95);
      }

      .panel::before {
        content: "";
        position: absolute;
        width: 100%;
        height: 20px;
        bottom: -20px;
        left: 0;
        background: rgba(0, 0, 0, 0.3);
        border-radius: 50%;
        filter: blur(10px);
        opacity: 0.7;
        transition: all 0.4s;
      }

      .panel:hover::before {
        opacity: 0.9;
        transform: scaleX(0.9);
      }

      .panel-image {
        width: 100%;
        height: 100%;
        object-fit: contain;
        transition: transform 0.3s;
      }

      .panel-content {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        padding: 20px;
        transform: translateY(60%);
        transition: transform 0.5s;
      }

      .panel:hover .panel-content {
        transform: translateY(50%);
      }

      .panel-title {
        font-size: 2.8rem;
        font-weight: 800;
        color: #ffea00;
        margin-bottom: 15px;
        text-shadow: 2px 2px 2px rgba(0, 0, 0, 0.5),
          0 0 10px rgba(255, 255, 255, 0.5);
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.5s 0.1s;
      }

      .panel:hover .panel-title {
        opacity: 1;
        transform: translateY(0);
      }

      .panel-description {
        color: #e5b565;
        font-size: 1.4rem;
        max-width: 85%;
        font-weight: bold;
        background-color: rgba(0, 0, 0, 0.4);
        padding: 15px;
        border-radius: 15px;
        transform: scale(0.9);
        opacity: 0.9;
        transition: all 0.4s;
      }

      .panel:hover .panel-description {
        transform: scale(1);
        opacity: 1;
        background-color: rgba(0, 0, 0, 0.6);
      }

      .character {
        position: absolute;
        width: 120px;
        height: 120px;
        background-size: contain;
        background-repeat: no-repeat;
        z-index: 5;
      }

      .character-left {
        bottom: 5%;
        left: 10%;
        background-image: url("../assets/Sprite/KeiraCheerful.png");
        animation: jumpCharacter 3s ease-in-out infinite;
      }

      .character-right {
        bottom: 5%;
        right: 10%;
        background-image: url("../assets/Sprite/keira.png");
        animation: jumpCharacter 3s ease-in-out infinite 1.5s;
      }

      @keyframes jumpCharacter {
        0%,
        100% {
          transform: translateY(0) rotate(0deg);
        }
        50% {
          transform: translateY(-20px) rotate(5deg);
        }
      }

      .particles {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 2;
      }

      .particle {
        position: absolute;
        width: 15px;
        height: 15px;
        background-color: white;
        border-radius: 50%;
        opacity: 0;
        pointer-events: none;
      }

      .selection-text {
        position: absolute;
        bottom: 10%;
        left: 50%;
        transform: translateX(-50%);
        font-size: 2rem;
        color: #ffffff;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.6);
        text-align: center;
        font-weight: bold;
        z-index: 10;
        animation: pulse 2s ease-in-out infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          transform: translateX(-50%) scale(1);
        }
        50% {
          transform: translateX(-50%) scale(1.05);
        }
      }

      .start-button {
        position: absolute;
        bottom: 5%;
        left: 50%;
        transform: translateX(-50%);
        padding: 15px 40px;
        background: linear-gradient(45deg, #ff9900, #ff6600);
        border: none;
        border-radius: 50px;
        font-size: 1.6rem;
        font-weight: bold;
        color: white;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        cursor: pointer;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        transition: all 0.3s;
        opacity: 0;
        z-index: 10;
        font-family: "Nunito", Arial, sans-serif;
      }

      .start-button:hover {
        transform: translateX(-50%) scale(1.05);
        box-shadow: 0 7px 20px rgba(0, 0, 0, 0.4);
        background: linear-gradient(45deg, #ffaa00, #ff7700);
      }

      .start-button:active {
        transform: translateX(-50%) scale(0.95);
      }

      .show-button {
        opacity: 1;
        animation: bounceIn 0.6s;
      }

      @keyframes bounceIn {
        0% {
          transform: translateX(-50%) scale(0.3);
          opacity: 0;
        }
        50% {
          transform: translateX(-50%) scale(1.1);
          opacity: 0.7;
        }
        70% {
          transform: translateX(-50%) scale(0.9);
        }
        100% {
          transform: translateX(-50%) scale(1);
          opacity: 1;
        }
      }

      .panel-highlight {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border-radius: 20px;
        box-shadow: 0 0 0 8px rgba(255, 234, 0, 0.7);
        opacity: 0;
        z-index: 2;
        pointer-events: none;
        transition: opacity 0.3s;
      }

      .show-highlight {
        opacity: 1;
        animation: highlight-pulse 2s infinite;
      }

      @keyframes highlight-pulse {
        0%,
        100% {
          box-shadow: 0 0 0 8px rgba(255, 234, 0, 0.7);
        }
        50% {
          box-shadow: 0 0 0 12px rgba(255, 234, 0, 0.9);
        }
      }

      .audio-button {
        position: absolute;
        top: 20px;
        right: 20px;
        width: 50px;
        height: 50px;
        background-color: rgba(255, 255, 255, 0.7);
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        z-index: 100;
        transition: all 0.3s;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
      }

      .audio-button:hover {
        transform: scale(1.1);
        background-color: rgba(255, 255, 255, 0.9);
      }

      .audio-icon {
        width: 30px;
        height: 30px;
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
      }

      @media (max-width: 768px) {
        .panels-container {
          flex-direction: column;
          align-items: center;
        }

        .panel {
          width: 90%;
          margin-bottom: 30px;
          height: 250px;
        }

        .logo-container {
          width: 150px;
          height: 150px;
          top: 2%;
        }

        .title-text {
          font-size: 1.8rem;
          top: 22%;
        }

        .panel-title {
          font-size: 2rem;
        }

        .panel-description {
          font-size: 1.1rem;
        }

        .selection-text {
          font-size: 1.5rem;
          bottom: 20%;
        }

        .start-button {
          font-size: 1.3rem;
          padding: 12px 30px;
        }

        .character {
          width: 80px;
          height: 80px;
        }
      }

      .intro-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.95);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        cursor: pointer;
        transition: opacity 1.5s ease-in-out;
      }

      .intro-logo {
        width: 250px;
        height: auto;
        margin-bottom: 40px;
        animation: glow 2s ease-in-out infinite alternate;
        filter: drop-shadow(0 0 15px rgba(255, 234, 0, 0.7));
      }

      .intro-text {
        font-size: 2rem;
        color: white;
        text-align: center;
        font-weight: bold;
        animation: pulse-text 2s infinite;
        text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
      }

      @keyframes pulse-text {
        0%,
        100% {
          opacity: 0.7;
          transform: scale(1);
        }
        50% {
          opacity: 1;
          transform: scale(1.05);
        }
      }

      .click-effect {
        position: absolute;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        border: 2px solid white;
        opacity: 0;
        transform: translate(-50%, -50%);
        pointer-events: none;
        z-index: 1001;
      }

      @keyframes click-wave {
        0% {
          width: 0px;
          height: 0px;
          opacity: 0.5;
        }
        100% {
          width: 200px;
          height: 200px;
          opacity: 0;
        }
      }

      /* Tambahan untuk Media Query */
      @media (max-width: 768px) {
        .intro-logo {
          width: 180px;
        }

        .intro-text {
          font-size: 1.6rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="intro-overlay" id="intro-overlay">
      <img
        src="../assets/SahabatAlam.png"
        alt="Sahabat Alam Logo"
        class="intro-logo"
      />
      <div class="intro-text">Klik untuk melanjutkan</div>
    </div>
    <div class="game-container">
      <!-- Forest Background -->
      <div class="background"></div>

      <!-- Floating Clouds -->
      <div class="floating-clouds">
        <div class="cloud cloud1"></div>
        <div class="cloud cloud2"></div>
        <div class="cloud cloud3"></div>
      </div>

      <!-- Characters -->
      <div class="character character-left"></div>
      <div class="character character-right"></div>

      <!-- Particles Container -->
      <div class="particles" id="particles-container"></div>

      <!-- Audio Button -->
      <div class="audio-button" id="audio-toggle">
        <div
          class="audio-icon"
          id="audio-icon"
          style="background-image: url('/api/placeholder/30/30')"
        ></div>
      </div>

      <!-- Logo/Title -->
      <div class="logo-container">
        <img
          src="../assets/SahabatAlam.png"
          alt="Sahabat Alam Logo"
          class="logo"
          id="game-logo"
        />
      </div>

      <!-- Wooden Panels -->
      <div class="panels-container">
        <!-- Left Panel - Tunarungu -->
        <div class="panel" id="tunarungu-panel">
          <div class="panel-highlight" id="tunarungu-highlight"></div>
          <img
            src="../assets/Button/tunarunguButton.png"
            alt="Panel Tunarungu"
            class="panel-image"
            id="left-panel-bg"
          />
          <div class="panel-content">
            <p class="panel-description">
              Kamu adalah seorang tunarungu, yang memiliki kondisi penurunan
              atau hilangnya kemampuan mendengar secara permanen
            </p>
          </div>
        </div>

        <!-- Right Panel - Tunanetra -->
        <div class="panel" id="tunanetra-panel">
          <div class="panel-highlight" id="tunanetra-highlight"></div>
          <img
            src="../assets/Button/tunanetraButton.png"
            alt="Panel Tunanetra"
            class="panel-image"
            id="right-panel-bg"
          />
          <div class="panel-content">
            <p class="panel-description">
              Kamu adalah seorang tunanetra, yang memiliki kondisi berkurangnya
              fungsi penglihatan mulai dari low vision hingga kebutaan total
            </p>
          </div>
        </div>
      </div>

      <button class="start-button" id="start-button">MULAI PETUALANGAN!</button>
    </div>

    <script>
      // Tambahkan variabel untuk background music
      const backgroundMusic = new Audio("../assets/sounds/BackSoundChoose.mp3"); // Sesuaikan path dengan file audio yang tersedia
      backgroundMusic.loop = true;
      backgroundMusic.volume = 0.2; // Volume default 30%

      document.addEventListener("DOMContentLoaded", function () {
        // Ambil elemen overlay intro
        const introOverlay = document.getElementById("intro-overlay");
        const gameContainer = document.querySelector(".game-container");

        // Sembunyikan game container sampai intro selesai
        gameContainer.style.opacity = "0";

        // Tambahkan event listener untuk klik pada overlay
        introOverlay.addEventListener("click", function (e) {
          // Buat efek klik visual
          const clickEffect = document.createElement("div");
          clickEffect.className = "click-effect";
          clickEffect.style.left = e.clientX + "px";
          clickEffect.style.top = e.clientY + "px";
          clickEffect.style.animation = "click-wave 1s forwards";
          document.body.appendChild(clickEffect);

          // Mulai memainkan musik latar
          if (audioEnabled) {
            backgroundMusic
              .play()
              .catch((error) =>
                console.log("Autoplay diblokir oleh browser:", error)
              );
          }

          // Fade out overlay intro
          introOverlay.style.opacity = "0";

          // Setelah animasi fade out selesai, hapus overlay dan tampilkan game container
          setTimeout(() => {
            introOverlay.style.display = "none";
            // Mulai animasi fade in untuk game container
            gameContainer.style.opacity = "1";

            // Jalankan efek partikel selamat datang setelah intro selesai
            setTimeout(() => {
              // Welcome particles
              for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                  createParticleBurst(
                    window.innerWidth * Math.random(),
                    window.innerHeight * Math.random(),
                    ["#ffea00", "#ff9900", "#ff6600", "#ffffff"][
                      Math.floor(Math.random() * 4)
                    ],
                    20
                  );
                }, i * 400);
              }
              playSound("welcome");
            }, 500);
          }, 1500);

          // Hapus efek click setelah animasi selesai
          setTimeout(() => {
            if (document.body.contains(clickEffect)) {
              document.body.removeChild(clickEffect);
            }
          }, 1000);
        });

        // Tambahkan efek highlight ke overlay saat mouse bergerak
        introOverlay.addEventListener("mousemove", function (e) {
          if (Math.random() < 0.1) {
            // Hanya buat partikel sesekali
            createParticle(e.pageX, e.pageY, "#ffea00");
          }
        });

        // Update fungsi toggle audio untuk juga mengontrol background music
        audioToggle.addEventListener("click", function () {
          audioEnabled = !audioEnabled;
          audioIcon.style.opacity = audioEnabled ? 1 : 0.5;
          playSound("click");

          // Kontrol background music
          if (audioEnabled) {
            backgroundMusic.play();
          } else {
            backgroundMusic.pause();
          }

          // Kontrol explanation audio
          if (!audioEnabled && currentExplanationAudio) {
            currentExplanationAudio.pause();
            currentExplanationAudio.currentTime = 0;
            currentExplanationAudio = null;
          }
        });
      });

      document.addEventListener("DOMContentLoaded", function () {
        // Start with opacity 0 (set in CSS)
        setTimeout(() => {
          document.body.style.opacity = "1"; // Fade in
        }, 100); // Slight delay to ensure transition works
      });

      // DOM Elements
      const tunarunguPanel = document.getElementById("tunarungu-panel");
      const tunanetraPanel = document.getElementById("tunanetra-panel");
      const startButton = document.getElementById("start-button");
      const tunarunguHighlight = document.getElementById("tunarungu-highlight");
      const tunanetraHighlight = document.getElementById("tunanetra-highlight");
      const particlesContainer = document.getElementById("particles-container");
      const audioToggle = document.getElementById("audio-toggle");
      const audioIcon = document.getElementById("audio-icon");

      // Game state
      let selectedCharacter = null;
      let audioEnabled = true;
      let isNavigating = false; // Flag to prevent multiple navigations

      // Tambahkan di bagian awal script atau deklarasi variabel
      const tunarunguAudio = new Audio("../assets/sounds/Tunarungu.mp3");
      const tunanetraAudio = new Audio("../assets/sounds/Tunanetra.mp3");
      let currentExplanationAudio = null;

      // Sound effects
      const playSound = (sound) => {
        if (!audioEnabled) return;
        console.log(`Playing sound: ${sound}`);
        // Here you would actually play the sound
        // const audio = new Audio(`sounds/${sound}.mp3`);
        // audio.play();
      };

      // Fungsi untuk memutar audio penjelasan
      function playExplanationAudio(audioElement) {
        if (!audioEnabled) return;

        // Hentikan audio yang sedang diputar
        if (currentExplanationAudio) {
          currentExplanationAudio.pause();
          currentExplanationAudio.currentTime = 0;
        }

        // Putar audio baru
        currentExplanationAudio = audioElement;
        currentExplanationAudio.play();
      }

      // Function to navigate to the next page with fade effect
      function navigateToGame(character) {
        // Prevent multiple navigations
        if (isNavigating) return;
        isNavigating = true;

        // Select the character for visual feedback
        selectedCharacter = character;

        // Reset highlights
        tunarunguHighlight.classList.remove("show-highlight");
        tunanetraHighlight.classList.remove("show-highlight");

        // Update UI based on selection
        if (character === "tunarungu") {
          tunarunguHighlight.classList.add("show-highlight");
        } else {
          tunanetraHighlight.classList.add("show-highlight");
        }

        // Play sound and create particle effect
        playSound("start");
        createParticleBurst(
          window.innerWidth / 2,
          window.innerHeight / 2,
          "#ff6600",
          30
        );

        // Fade out animation
        document.body.style.transition = "opacity 1s";
        document.body.style.opacity = 0;

        // Navigate to the appropriate page after fade completes
        setTimeout(() => {
          console.log(`Navigating to ${character} game page`);
          window.location.href = `game-${character}.html`;
        }, 1000);
      }

      // Particle system
      function createParticle(x, y, color) {
        const particle = document.createElement("div");
        particle.className = "particle";
        particle.style.left = `${x}px`;
        particle.style.top = `${y}px`;
        particle.style.backgroundColor = color;
        particle.style.boxShadow = `0 0 10px ${color}`;
        particlesContainer.appendChild(particle);

        // Animate and remove
        const angle = Math.random() * Math.PI * 2;
        const speed = 2 + Math.random() * 3;
        const size = 5 + Math.random() * 10;
        let opacity = 0.7;
        let posX = x;
        let posY = y;

        particle.style.width = `${size}px`;
        particle.style.height = `${size}px`;

        const animation = setInterval(() => {
          posX += Math.cos(angle) * speed;
          posY += Math.sin(angle) * speed - 0.5; // Slight upward drift
          opacity -= 0.01;

          particle.style.left = `${posX}px`;
          particle.style.top = `${posY}px`;
          particle.style.opacity = opacity;

          if (opacity <= 0) {
            clearInterval(animation);
            particlesContainer.removeChild(particle);
          }
        }, 20);
      }

      function createParticleBurst(x, y, color, count = 20) {
        for (let i = 0; i < count; i++) {
          setTimeout(() => {
            createParticle(
              x - 10 + Math.random() * 20,
              y - 10 + Math.random() * 20,
              color
            );
          }, i * 20);
        }
      }

      // Character selection function (visual only now)
      function selectCharacter(character) {
        selectedCharacter = character;

        // Reset highlights
        tunarunguHighlight.classList.remove("show-highlight");
        tunanetraHighlight.classList.remove("show-highlight");

        // Update UI based on selection
        if (character === "tunarungu") {
          tunarunguHighlight.classList.add("show-highlight");
          createParticleBurst(
            tunarunguPanel.offsetLeft + tunarunguPanel.offsetWidth / 2,
            tunarunguPanel.offsetTop + tunarunguPanel.offsetHeight / 2,
            "#ffea00"
          );
        } else {
          tunanetraHighlight.classList.add("show-highlight");
          createParticleBurst(
            tunanetraPanel.offsetLeft + tunanetraPanel.offsetWidth / 2,
            tunanetraPanel.offsetTop + tunanetraPanel.offsetHeight / 2,
            "#ffea00"
          );
        }

        // Show start button
        startButton.classList.add("show-button");

        playSound("select");
      }

      // Update toggle audio
      audioToggle.addEventListener("click", function () {
        audioEnabled = !audioEnabled;
        audioIcon.style.opacity = audioEnabled ? 1 : 0.5;
        playSound("click");

        // Control background music
        if (audioEnabled) {
          backgroundMusic.play();
        } else {
          backgroundMusic.pause();
        }

        // Jika audio dimatikan, hentikan penjelasan yang sedang diputar
        if (!audioEnabled && currentExplanationAudio) {
          currentExplanationAudio.pause();
          currentExplanationAudio.currentTime = 0;
          currentExplanationAudio = null;
        }
      });

      // Event listeners for panels
      tunarunguPanel.addEventListener("mouseover", function () {
        playExplanationAudio(tunarunguAudio);

        if (selectedCharacter !== "tunarungu") {
          playSound("hover");
        }
      });

      tunarunguPanel.addEventListener("mouseout", function () {
        if (currentExplanationAudio === tunarunguAudio) {
          currentExplanationAudio.pause();
          currentExplanationAudio.currentTime = 0;
          currentExplanationAudio = null;
        }
      });

      tunanetraPanel.addEventListener("mouseover", function () {
        playExplanationAudio(tunanetraAudio);

        if (selectedCharacter !== "tunanetra") {
          playSound("hover");
        }
      });

      tunanetraPanel.addEventListener("mouseout", function () {
        if (currentExplanationAudio === tunanetraAudio) {
          currentExplanationAudio.pause();
          currentExplanationAudio.currentTime = 0;
          currentExplanationAudio = null;
        }
      });

      // Update panel click event listeners to navigate directly
      tunarunguPanel.addEventListener("click", function (e) {
        // Create particle burst at click position first for visual feedback
        createParticleBurst(e.pageX, e.pageY, "#ff9900", 10);
        playSound("select");

        // Select character visually
        selectCharacter("tunarungu");

        // Navigate after a short delay to allow visual feedback
        setTimeout(() => {
          navigateToGame("tunarungu");
        }, 300);
      });

      tunanetraPanel.addEventListener("click", function (e) {
        // Create particle burst at click position first for visual feedback
        createParticleBurst(e.pageX, e.pageY, "#ff9900", 10);
        playSound("select");

        // Select character visually
        selectCharacter("tunanetra");

        // Navigate after a short delay to allow visual feedback
        setTimeout(() => {
          navigateToGame("tunanetra");
        }, 300);
      });

      // Update start button to navigate if a character is selected
      startButton.addEventListener("click", function () {
        if (!selectedCharacter || isNavigating) return;
        navigateToGame(selectedCharacter);
      });

      // Create initial particle effects
      window.addEventListener("load", function () {
        // Welcome particles
        for (let i = 0; i < 3; i++) {
          setTimeout(() => {
            createParticleBurst(
              window.innerWidth * Math.random(),
              window.innerHeight * Math.random(),
              ["#ffea00", "#ff9900", "#ff6600"][Math.floor(Math.random() * 3)],
              15
            );
          }, i * 500);
        }

        playSound("welcome");
      });

      // Interactive background particles on mouse move
      document.addEventListener("mousemove", function (e) {
        if (Math.random() < 0.03) {
          // Only create particles occasionally
          createParticle(e.pageX, e.pageY, "#ffffff");
        }
      });
    </script>
  </body>
</html>
